
============================================================
-- MemorySpaceAttr --
------------------------------------------------------------
Constructed: #frisk<memory_space Local> (enum = 0)
Constructed: #frisk<memory_space Global> (enum = 1)
Constructed: #frisk<memory_space Shared> (enum = 3)
Parsed: #frisk<memory_space Shared> -> enum = 3

============================================================
-- GemmWarpPolicyAttr --
------------------------------------------------------------
Constructed: #frisk<gemm_warp_policy Square> (enum = 0)
Constructed: #frisk<gemm_warp_policy FullRow> (enum = 1)
Constructed: #frisk<gemm_warp_policy FullCol> (enum = 2)
Parsed: #frisk<gemm_warp_policy FullRow> -> enum = 1

============================================================
-- LayoutAttr --
------------------------------------------------------------
Constructed layout: #frisk.layout<[4, 4], affine_map<(d0, d1) -> (d0 * 4 + d1)>>

============================================================
-- Gemm Layout Inference --
------------------------------------------------------------

============================================================
-- Constructed Module IR --
------------------------------------------------------------
module attributes {frisk.target = "sm_80"} {
  frisk.kernel @test(memref<128x64xf16, 3>, memref<64x128xf16, 3>, memref<128x128xf16>) {
    frisk.gemm(%arg0, %arg1, %arg2) {K = 64 : i64, M = 128 : i64, N = 128 : i64, clear_accum = false, 
                                     frisk.threads = 128 : i64, 
                                     policy = #frisk<gemm_warp_policy Square>, 
                                     transA = false, transB = false
                                     } : 
      memref<128x64xf16, 3>, memref<64x128xf16, 3>, memref<128x128xf16>
  }
}

A layout forward map: affine_map<(d0, d1) -> ((d1 floordiv 8) floordiv 8, d0 floordiv 8, d1 mod 8 + (((((((d1 floordiv 8) mod 8) floordiv 2) floordiv 2 + ((d0 mod 8) floordiv 2) floordiv 2) mod 2) * 2 + ((((d1 floordiv 8) mod 8) floordiv 2) mod 2 + ((d0 mod 8) floordiv 2) mod 2) mod 2) * 2 + ((d1 floordiv 8) mod 2 + d0 mod 2) mod 2 + (d0 mod 8) * 8) * 8)>
B layout forward map: affine_map<(d0, d1) -> ((d1 floordiv 8) floordiv 8, d0 floordiv 8, d1 mod 8 + (((((((d1 floordiv 8) mod 8) floordiv 2) floordiv 2 + ((d0 mod 8) floordiv 2) floordiv 2) mod 2) * 2 + ((((d1 floordiv 8) mod 8) floordiv 2) mod 2 + ((d0 mod 8) floordiv 2) mod 2) mod 2) * 2 + ((d1 floordiv 8) mod 2 + d0 mod 2) mod 2 + (d0 mod 8) * 8) * 8)>
C layout forward map: affine_map<(d0, d1) -> (d1 mod 2 + ((d1 mod 8) floordiv 8 + (d0 mod 16) floordiv 8) * 2 + (d0 floordiv 32 + (d1 floordiv 16) * 4) * 4)>

============================================================
All Frisk attributes are usable.
